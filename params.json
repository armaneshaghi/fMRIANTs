{"name":"Fmriants","tagline":"Minimal fMRI pre-processing with ANTS","body":"fMRIANTs\r\n========\r\n\r\nMinimal fMRI pre-processing with ANTS\r\n\r\n```\r\nfmri=data/bold.nii.gz\r\nnm=data/AFFINE\r\nref=${nm}_avg.nii.gz\r\nantsMotionCorr -d 3 -a $fmri -o $ref\r\nantsMotionCorr  -d 3 -o [ ${nm}, ${nm}.nii.gz,${nm}_avg.nii.gz] -m MI[${ref}, ${fmri}, 1 , 32 , Regular, 0.01  ] -t Affine[ 0.1 ] -u 1 -e 1 -s 1x0 -f 2x1 -i 3x0 -n 3  \r\n#\r\n# this is a 'fast' example - you should change -i 3x0 to something larger \r\n# and Regular, 0.01 to Regular, 0.2 for 'real' data - see AFFINE_AND_DEFORMABLE below\r\n#\r\n###########################################\r\n### now do deformable motion correction ###\r\n###########################################\r\nnm=data/AFFINE_AND_DEFORMABLE\r\nantsMotionCorr  -d 3 -o [ ${nm}, ${nm}.nii.gz,${nm}_avg.nii.gz] -m MI[${ref}, ${fmri}, 1 , 32 , Regular, 0.2  ] -t Affine[ 0.1 ] -u 1 -e 1 -s 1x0 -f 2x1 -i 33x20 -n 3  -m MI[${ref}, ${fmri}, 1 , 32 ] -t GaussianDisplacementField[0.15,3,0.5] -i 33x20 -u 1 -e 1 -s 1x0 -f 4x1 -n 3\r\n```\r\n\r\nThe csv and result images that come out contain the motion corrected image and the motion nuisance variables - but you need to run the affine version to get the motion variables ( that's a small bug in that the 2nd level registration doesnt maintain the 1st level motion results ) .... It might be interesting to also write out the deformation field in order to quantify distortion but that is a separate issue.\r\n\r\nNext you can run the CompCor command to estimate physiological nuisance variables.\r\n\r\n```\r\n# \r\n# CompCor needs a mask --- you can get the mask by (might need to alter the value 200 up or down) \r\n#\r\nThresholdImage 3  data/AFFINE_avg.nii.gz data/mask.nii.gz 200 1.e9 \r\nImageMath 3 data/mask.nii.gz ME data/mask.nii.gz 1 \r\nImageMath 3 data/mask.nii.gz GetLargestComponent data/mask.nii.gz\r\nImageMath 3 data/mask.nii.gz MD data/mask.nii.gz 2 \r\nImageMath 3 data/mask.nii.gz ME data/mask.nii.gz 1 \r\n# you may alternatively run CompCor on the motion-corrected data\r\nImageMath 4 data/OUT.nii.gz CompCorrAuto data/bold.nii.gz data/mask.nii.gz 6 \r\n#\r\n# the important output will be called  OUT_compcorr.csv \r\n#\r\n```\r\n\r\nFor T1 processing : see\r\n\r\n(NeuroBattery)[http://jeffduda.github.io/NeuroBattery/]\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}